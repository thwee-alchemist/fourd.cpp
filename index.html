<!DOCTYPE html>
<html>
    <head>
      <meta charset="utf-8">
      <title>fourd.wasm</title>
      <meta author="joshua.moore@leudla.net">
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
      <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    </head>
    <body>
      <h2>fourd.wasm</h2>
      <p>fourd.wasm is a rewrite of <a href="https://github.com/thwee-alchemist/FourDSocketProxy/blob/master/lib/fourd.js">fourd.js</a> in <a href="https://github.com/thwee-alchemist/fourd.cpp/blob/gh-pages/fourd.cpp">C++</a>, compiled to web assembly.</p>
      <p> Eventually this work will flow into <a href="https://www.npmjs.com/package/fourdsocketproxy">fourdsocketproxy</a></p>
      <p>To see this animation in action: 
        <ol>
          <li>Click +v twice.</li>
          <li>Click +e once</li>
          <li>Enter 0 (zero) when prompted for the edge's source.</li>
          <li>Enter 1 (one) when prompted for the edge's target.</li>
          <li>Carefully play with the values below. (The fourd.graph.settings object lets you set these values via the console.)</li>
          <li>When it breaks, hit refresh</li>
          <li class="warning">This animation may cause seizures!</li>
        </ol>

      </p>
      <div class="container well">
        <span class="col-md-6">
            <div class="display"></div>
        </span>
          
        <div class="col-md-6">
          <button 
            class="btn btn-primary" 
            onclick="fourd.graph.add_vertex(options);">
            +v
          </button>
          
          <button 
            class="btn btn-primary" 
            onclick="fourd.graph.add_edge(graph.V.get(parseInt(prompt('Source?'))), graph.V.get(parseInt(prompt('Target?'))), {color: 0xffffff, strength: 1.0});">
            +e
          </button>
        </div>

        <div class="well col-md-6">
          <form oninput="
            repulsion.value = fourd.graph.settings.repulsion;
            attraction.value = fourd.graph.settings.attraction;
            epsilon.value = fourd.graph.settings.epsilon;
            friction.value = fourd.graph.settings.friction;
            inner_distance.value = fourd.graph.settings.inner_distance;
            ">
          <label class="lbl form-label" for="repulsion">Repulsion
            <output 
              name="repulsion"
              value="fourd.graph.settings.repulsion">
            </output>
          </label>
          <input 
            class="range form-control" 
            value="fourd.graph.settings.repulsion" 
            onchange="console.log(fourd.graph.settings.repulsion = parseFloat(this.value));"
            id="repulsion"
            type="range"
            min="0.0" 
            max="50.0" 
            step=".1"> 

          <label class="lbl form-label" for="attraction">Attraction: 
            <output
              name="attraction"
              value="fourd.graph.settings.attraction"">
            </output>
          </label>
          <input 
            class="range form-control" 
            value="fourd.graph.settings.attraction" 
            onchange="console.log(fourd.graph.settings.attraction = parseFloat(this.value));"
            id="attraction" 
            type="range" 
            min="0.0" 
            max="50.0" 
            step=".1">

          <label class="lbl form-label" for="epsilon">Epsilon
            <output
              name="epsilon"
              value="fourd.graph.settings.epsilon"">
            </output>
          </label>
          <input 
            class="range form-control" 
            value="fourd.graph.settings.epsilon" 
            onchange="console.log(fourd.graph.settings.epsilon = parseFloat(this.value));"
            id="epsilon" 
            type="range" 
            min="0.0" 
            max="10.0" 
            step=".1">

          <label class="lbl form-label" for="friction">Friction
              <output
                name="friction"
                value="fourd.graph.settings.friction"">
              </output>
            </label>
            <input 
              class="range form-control" 
              value="fourd.graph.settings.friction" 
              onchange="console.log(fourd.graph.settings.friction = parseFloat(this.value));"
              id="friction" 
              type="range" 
              min="0.0" 
              max="1.0" 
              step=".1">

          <label class="lbl form-label" for="inner_distance">Inner Distance
              <output
                name="inner_distance"
                value="fourd.graph.settings.inner_distance"">
              </output>
            </label>
            <input 
              class="range form-control" 
              value="fourd.graph.settings.inner_distance" 
              onchange="console.log(inner_distance.value = fourd.graph.settings.inner_distance = parseFloat(this.value));"
              id="inner_distance" 
              type="range" 
              min="0.0" 
              max="100.0" 
              step=".1">
          </form>
        </div>
      </div>
      <script src="r103.three.min.js"></script>
      <script src="OrbitControls.js"></script>
      <script src="fourd.js"></script>
      <script src="jquery-1.11.3.min.js"></script>
      <script src="animation.js"></script>

      <script>

Module.onRuntimeInitialized = _ => {

  fourd = new FourD(
    document.querySelector('.display'), 
    {
      border: '1px solid black',
      width: 500,
      height: 250,
      background: 0x004477
    }, 
    Module.default_settings,
    Module.LayoutGraph
  );

  options = {cube: {size: 10, color: 0xffffff}};

  console.log(graph.vertex_count);
};
        </script>
    </body>
</html>